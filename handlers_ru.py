"""–†—É—Å—Å–∫–∏–π –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –°–æ–æ–±—â–µ–Ω–∏–π"""

import asyncio
import time
from datetime import datetime
from typing import Any, Dict, List, Optional

import structlog
from config_ru import –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç, —ç—Ç–æ_–∞–¥–º–∏–Ω, –ø–æ–ª—É—á–∏—Ç—å_–ª–∏–º–∏—Ç—ã_—Ç–∞—Ä–∏—Ñ–∞

–ª–æ–≥ = structlog.get_logger("–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏")


class –û–±—Ä–∞–±–æ—Ç—á–∏–∫–°–æ–æ–±—â–µ–Ω–∏–π:
    """–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ä—É—Å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π —Å–æ –≤—Å–µ–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –±–æ—Ç–∞."""
    
    def __init__(self, —Ç–µ–ª–µ–≥—Ä–∞–º_–∫–ª–∏–µ–Ω—Ç, –æ–ø–µ–Ω–∞–∏_–∫–ª–∏–µ–Ω—Ç, –º–µ–Ω–µ–¥–∂–µ—Ä_–±–¥, –º–µ–Ω–µ–¥–∂–µ—Ä_–ø–ª–∞—Ç–µ–∂–µ–π, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞_–¥–≤–∏–∂–æ–∫):
        self.—Ç–µ–ª–µ–≥—Ä–∞–º = —Ç–µ–ª–µ–≥—Ä–∞–º_–∫–ª–∏–µ–Ω—Ç
        self.–æ–ø–µ–Ω–∞–∏ = –æ–ø–µ–Ω–∞–∏_–∫–ª–∏–µ–Ω—Ç
        self.–±–¥ = –º–µ–Ω–µ–¥–∂–µ—Ä_–±–¥
        self.–ø–ª–∞—Ç–µ–∂–∏ = –º–µ–Ω–µ–¥–∂–µ—Ä_–ø–ª–∞—Ç–µ–∂–µ–π
        self.–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ = –∞–Ω–∞–ª–∏—Ç–∏–∫–∞_–¥–≤–∏–∂–æ–∫
        
        # –°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
        self.—Å–æ—Å—Ç–æ—è–Ω–∏—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = {}
    
    async def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(self, —Å–æ–æ–±—â–µ–Ω–∏–µ: Dict[str, Any]):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ."""
        –≤—Ä–µ–º—è_—Å—Ç–∞—Ä—Ç–∞ = time.perf_counter()
        
        try:
            –¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = —Å–æ–æ–±—â–µ–Ω–∏–µ.get("from", {})
            –∏–¥_—á–∞—Ç–∞ = —Å–æ–æ–±—â–µ–Ω–∏–µ["chat"]["id"]
            —Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥ = –¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è["id"]
            
            # –ü–æ–ª—É—á–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = await self.–±–¥.–ø–æ–ª—É—á–∏—Ç—å_–∏–ª–∏_—Å–æ–∑–¥–∞—Ç—å_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(
                —Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥=—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥,
                –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è=–¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.get("username"),
                –∏–º—è=–¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.get("first_name"),
                —Ñ–∞–º–∏–ª–∏—è=–¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.get("last_name"),
                –∫–æ–¥_—è–∑—ã–∫–∞=–¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.get("language_code", "ru")
            )
            
            # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            if –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω:
                await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                    –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                    —Ç–µ–∫—Å—Ç="‚ùå –í—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã"
                )
                return
            
            # –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π
            if "text" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ç–µ–∫—Å—Ç–æ–≤–æ–µ_—Å–æ–æ–±—â–µ–Ω–∏–µ(—Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            elif "photo" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ñ–æ—Ç–æ_—Å–æ–æ–±—â–µ–Ω–∏–µ(—Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            elif "voice" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–≥–æ–ª–æ—Å–æ–≤–æ–µ_—Å–æ–æ–±—â–µ–Ω–∏–µ(—Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            elif "document" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–¥–æ–∫—É–º–µ–Ω—Ç_—Å–æ–æ–±—â–µ–Ω–∏–µ(—Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            
            # –ó–∞–ø–∏—Å–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É
            –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å = time.perf_counter() - –≤—Ä–µ–º—è_—Å—Ç–∞—Ä—Ç–∞
            if self.–∞–Ω–∞–ª–∏—Ç–∏–∫–∞:
                self.–∞–Ω–∞–ª–∏—Ç–∏–∫–∞.–∑–∞–ø–∏—Å–∞—Ç—å_–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ_—Å–æ–æ–±—â–µ–Ω–∏–µ(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∏–¥, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
            
        except Exception as e:
            –ª–æ–≥.error("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è", –æ—à–∏–±–∫–∞=str(e))
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ç–µ–∫—Å—Ç–æ–≤–æ–µ_—Å–æ–æ–±—â–µ–Ω–∏–µ(self, —Å–æ–æ–±—â–µ–Ω–∏–µ: Dict[str, Any], –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è."""
        —Ç–µ–∫—Å—Ç = —Å–æ–æ–±—â–µ–Ω–∏–µ["text"]
        –∏–¥_—á–∞—Ç–∞ = —Å–æ–æ–±—â–µ–Ω–∏–µ["chat"]["id"]
        
        # –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã
        if —Ç–µ–∫—Å—Ç.startswith("/"):
            await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–º–∞–Ω–¥—É(—Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            return
        
        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –≤–≤–æ–¥–æ–≤
        —Å–æ—Å—Ç–æ—è–Ω–∏–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = self.—Å–æ—Å—Ç–æ—è–Ω–∏—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.get(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥)
        if —Å–æ—Å—Ç–æ—è–Ω–∏–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
            await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–≤–≤–æ–¥_—Å–æ—Å—Ç–æ—è–Ω–∏—è(—Ç–µ–∫—Å—Ç, —Å–æ—Å—Ç–æ—è–Ω–∏–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            return
        
        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã
        –ª–∏–º–∏—Ç—ã = await self.–±–¥.–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ª–∏–º–∏—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥)
        if not –ª–∏–º–∏—Ç—ã["–º–æ–∂–µ—Ç_–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ"]:
            await self._–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ_–ª–∏–º–∏—Ç–æ–≤(–∏–¥_—á–∞—Ç–∞, –ª–∏–º–∏—Ç—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞)
            return
        
        # –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        if –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.–≤–∫–ª—é—á–∏—Ç—å_–º–æ–¥–µ—Ä–∞—Ü–∏—é_–∫–æ–Ω—Ç–µ–Ω—Ç–∞:
            –º–æ–¥–µ—Ä–∞—Ü–∏—è = await self.–æ–ø–µ–Ω–∞–∏.–º–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–∫–æ–Ω—Ç–µ–Ω—Ç(—Ç–µ–∫—Å—Ç)
            if –º–æ–¥–µ—Ä–∞—Ü–∏—è["–ø–æ–º–µ—á–µ–Ω–æ"]:
                await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                    –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                    —Ç–µ–∫—Å—Ç=–ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–æ—à–∏–±–∫–∞_–º–æ–¥–µ—Ä–∞—Ü–∏–∏", –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞)
                )
                return
        
        # –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –ø–µ—á–∞—Ç–∞–µ—Ç
        await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–ø–µ—á–∞—Ç–∞–µ—Ç(–∏–¥_—á–∞—Ç–∞)
        
        # –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è OpenAI
        —Å–æ–æ–±—â–µ–Ω–∏—è = [
            {"role": "user", "content": —Ç–µ–∫—Å—Ç}
        ]
        
        # –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç
        –æ—Ç–≤–µ—Ç = await self.–æ–ø–µ–Ω–∞–∏.–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ_—á–∞—Ç–∞(
            —Å–æ–æ–±—â–µ–Ω–∏—è=—Å–æ–æ–±—â–µ–Ω–∏—è,
            –∏–¥_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è=–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∏–¥,
            –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã=True
        )
        
        # –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç
        await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
            –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
            —Ç–µ–∫—Å—Ç=–æ—Ç–≤–µ—Ç["—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ"],
            —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=self.—Ç–µ–ª–µ–≥—Ä–∞–º.–ø–æ–ª—É—á–∏—Ç—å_–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞, —ç—Ç–æ_–∞–¥–º–∏–Ω(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥))
        )
        
        # –û–±–Ω–æ–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
        await self.–±–¥.—É–≤–µ–ª–∏—á–∏—Ç—å_–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥, "—Å–æ–æ–±—â–µ–Ω–∏—è", 1)
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–º–∞–Ω–¥—É(self, —Å–æ–æ–±—â–µ–Ω–∏–µ: Dict[str, Any], –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞."""
        —Ç–µ–∫—Å—Ç = —Å–æ–æ–±—â–µ–Ω–∏–µ["text"]
        –∏–¥_—á–∞—Ç–∞ = —Å–æ–æ–±—â–µ–Ω–∏–µ["chat"]["id"]
        –∫–æ–º–∞–Ω–¥–∞ = —Ç–µ–∫—Å—Ç.split()[0].lower()
        
        if –∫–æ–º–∞–Ω–¥–∞ == "/start":
            await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–º–∞–Ω–¥—É_—Å—Ç–∞—Ä—Ç(–∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
        elif –∫–æ–º–∞–Ω–¥–∞ == "/help":
            await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–º–∞–Ω–¥—É_–ø–æ–º–æ—â—å(–∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
        elif –∫–æ–º–∞–Ω–¥–∞ == "/stats" and —ç—Ç–æ_–∞–¥–º–∏–Ω(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥):
            await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–º–∞–Ω–¥—É_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞(–∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–º–∞–Ω–¥—É_—Å—Ç–∞—Ä—Ç(self, –∏–¥_—á–∞—Ç–∞: int, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–º–∞–Ω–¥—É /start - –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø."""
        –∏–º—è = –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∏–º—è or "–î—Ä—É–≥"
        —Ç–µ–∫—Å—Ç_–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è = –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ", –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞, –∏–º—è=–∏–º—è)
        –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = self.—Ç–µ–ª–µ–≥—Ä–∞–º.–ø–æ–ª—É—á–∏—Ç—å_–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞, —ç—Ç–æ_–∞–¥–º–∏–Ω(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥))
        
        await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
            –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
            —Ç–µ–∫—Å—Ç=—Ç–µ–∫—Å—Ç_–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è,
            —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
        )
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ñ–æ—Ç–æ_—Å–æ–æ–±—â–µ–Ω–∏–µ(self, —Å–æ–æ–±—â–µ–Ω–∏–µ: Dict[str, Any], –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–æ—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è."""
        if not –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.—Ñ—É–Ω–∫—Ü–∏–∏.–≤–∫–ª—é—á–∏—Ç—å_–≤–∏–¥–µ–Ω–∏–µ:
            return
        
        –∏–¥_—á–∞—Ç–∞ = —Å–æ–æ–±—â–µ–Ω–∏–µ["chat"]["id"]
        
        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã
        –ª–∏–º–∏—Ç—ã = await self.–±–¥.–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ª–∏–º–∏—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥)
        if not –ª–∏–º–∏—Ç—ã["–º–æ–∂–µ—Ç_–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ"]:
            await self._–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ_–ª–∏–º–∏—Ç–æ–≤(–∏–¥_—á–∞—Ç–∞, –ª–∏–º–∏—Ç—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞)
            return
        
        await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–¥–µ–π—Å—Ç–≤–∏–µ_—á–∞—Ç–∞(–∏–¥_—á–∞—Ç–∞, "typing")
        
        try:
            # –ü–æ–ª—É—á–∏—Ç—å —Å–∞–º–æ–µ –±–æ–ª—å—à–æ–µ —Ñ–æ—Ç–æ
            —Ñ–æ—Ç–æ = max(—Å–æ–æ–±—â–µ–Ω–∏–µ["photo"], key=lambda x: x.get("file_size", 0))
            
            # –°–∫–∞—á–∞—Ç—å —Ñ–æ—Ç–æ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
            –ø–æ–¥–ø–∏—Å—å = —Å–æ–æ–±—â–µ–Ω–∏–µ.get("caption", "–û–ø–∏—à–∏—Ç–µ —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ")
            –∞–Ω–∞–ª–∏–∑ = f"üîç **–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**\n\n–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è... \n\nüì∏ –û–ø–∏—Å–∞–Ω–∏–µ: {–ø–æ–¥–ø–∏—Å—å}"
            
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç=–∞–Ω–∞–ª–∏–∑,
                –æ—Ç–≤–µ—Ç_–Ω–∞_—Å–æ–æ–±—â–µ–Ω–∏–µ_–∏–¥=—Å–æ–æ–±—â–µ–Ω–∏–µ["message_id"]
            )
            
        except Exception as e:
            –ª–æ–≥.error("–ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ –Ω–µ —É–¥–∞–ª—Å—è", –æ—à–∏–±–∫–∞=str(e))
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç=–ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–æ—à–∏–±–∫–∞_–æ–±—â–∞—è", –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞)
            )
    
    async def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å(self, –∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å: Dict[str, Any]):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–ª–±–µ–∫ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä - –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø."""
        try:
            –∏–¥_–∑–∞–ø—Ä–æ—Å–∞ = –∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å["id"]
            –¥–∞–Ω–Ω—ã–µ = –∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å["data"]
            —Å–æ–æ–±—â–µ–Ω–∏–µ = –∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å["message"]
            –∏–¥_—á–∞—Ç–∞ = —Å–æ–æ–±—â–µ–Ω–∏–µ["chat"]["id"]
            –¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = –∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å["from"]
            
            –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = await self.–±–¥.–ø–æ–ª—É—á–∏—Ç—å_–∏–ª–∏_—Å–æ–∑–¥–∞—Ç—å_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(–¥–∞–Ω–Ω—ã–µ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è["id"])
            if not –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
                await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–≤–µ—Ç–∏—Ç—å_–Ω–∞_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å(–∏–¥_–∑–∞–ø—Ä–æ—Å–∞, "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
                return
            
            # –†–∞–∑–±–æ—Ä callback –¥–∞–Ω–Ω—ã—Ö
            —á–∞—Å—Ç–∏ = –¥–∞–Ω–Ω—ã–µ.split(":")
            –¥–µ–π—Å—Ç–≤–∏–µ = —á–∞—Å—Ç–∏[0]
            –ø–∞—Ä–∞–º–µ—Ç—Ä = —á–∞—Å—Ç–∏[1] if len(—á–∞—Å—Ç–∏) > 1 else None
            
            # –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º
            if –¥–µ–π—Å—Ç–≤–∏–µ == "—Ñ—É–Ω–∫—Ü–∏—è":
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ñ—É–Ω–∫—Ü–∏—é_–∫–æ–ª–±–µ–∫(–ø–∞—Ä–∞–º–µ—Ç—Ä, –∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            elif –¥–µ–π—Å—Ç–≤–∏–µ == "–ø–µ—Ä—Å–æ–Ω—ã":
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–ø–µ—Ä—Å–æ–Ω—ã_–∫–æ–ª–±–µ–∫(–ø–∞—Ä–∞–º–µ—Ç—Ä, –∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            elif –¥–µ–π—Å—Ç–≤–∏–µ == "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã":
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã_–∫–æ–ª–±–µ–∫(–ø–∞—Ä–∞–º–µ—Ç—Ä, –∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            elif –¥–µ–π—Å—Ç–≤–∏–µ == "–∏–≥—Ä—ã":
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∏–≥—Ä—ã_–∫–æ–ª–±–µ–∫(–ø–∞—Ä–∞–º–µ—Ç—Ä, –∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            elif –¥–µ–π—Å—Ç–≤–∏–µ == "–ø—Ä–µ–º–∏—É–º":
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–ø—Ä–µ–º–∏—É–º_–∫–æ–ª–±–µ–∫(–ø–∞—Ä–∞–º–µ—Ç—Ä, –∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            elif –¥–µ–π—Å—Ç–≤–∏–µ == "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞":
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É_–∫–æ–ª–±–µ–∫(–ø–∞—Ä–∞–º–µ—Ç—Ä, –∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            elif –¥–µ–π—Å—Ç–≤–∏–µ == "–Ω–∞—Å—Ç—Ä–æ–π–∫–∏":
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–Ω–∞—Å—Ç—Ä–æ–π–∫–∏_–∫–æ–ª–±–µ–∫(–ø–∞—Ä–∞–º–µ—Ç—Ä, –∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            
            # –û—Ç–≤–µ—Ç –Ω–∞ callback
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–≤–µ—Ç–∏—Ç—å_–Ω–∞_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å(–∏–¥_–∑–∞–ø—Ä–æ—Å–∞, "‚úÖ")
            
            # –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∫–æ–ª–±–µ–∫–æ–≤
            if –¥–∞–Ω–Ω—ã–µ.startswith("–≥–ª–∞–≤–Ω–æ–µ_"):
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–ª–±–µ–∫_–≥–ª–∞–≤–Ω–æ–≥–æ_–º–µ–Ω—é(–¥–∞–Ω–Ω—ã–µ, —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∏–¥_–∑–∞–ø—Ä–æ—Å–∞)
            elif –¥–∞–Ω–Ω—ã–µ.startswith("–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_"):
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–ª–±–µ–∫_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞(–¥–∞–Ω–Ω—ã–µ, —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∏–¥_–∑–∞–ø—Ä–æ—Å–∞)
            elif –¥–∞–Ω–Ω—ã–µ.startswith("–∞–¥–º–∏–Ω_"):
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–ª–±–µ–∫_–∞–¥–º–∏–Ω–∞(–¥–∞–Ω–Ω—ã–µ, —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∏–¥_–∑–∞–ø—Ä–æ—Å–∞)
            elif –¥–∞–Ω–Ω—ã–µ.startswith("–ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è_"):
                await self._–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–ª–±–µ–∫_–ø–æ–¥–ø–∏—Å–∫–∏(–¥–∞–Ω–Ω—ã–µ, —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∏–¥_–∑–∞–ø—Ä–æ—Å–∞)
            
        except Exception as e:
            –ª–æ–≥.error("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–ª–±–µ–∫ –∑–∞–ø—Ä–æ—Å–∞", –æ—à–∏–±–∫–∞=str(e))
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∫–æ–ª–±–µ–∫_–≥–ª–∞–≤–Ω–æ–≥–æ_–º–µ–Ω—é(self, –¥–∞–Ω–Ω—ã–µ: str, —Å–æ–æ–±—â–µ–Ω–∏–µ: Dict, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∏–¥_–∑–∞–ø—Ä–æ—Å–∞: str):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–ª–±–µ–∫–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é."""
        –∏–¥_—á–∞—Ç–∞ = —Å–æ–æ–±—â–µ–Ω–∏–µ["chat"]["id"]
        –∏–¥_—Å–æ–æ–±—â–µ–Ω–∏—è = —Å–æ–æ–±—â–µ–Ω–∏–µ["message_id"]
        
        if –¥–∞–Ω–Ω—ã–µ == "–≥–ª–∞–≤–Ω–æ–µ_—á–∞—Ç":
            —Ç–µ–∫—Å—Ç = "üí¨ –†–µ–∂–∏–º —á–∞—Ç–∞ –∞–∫—Ç–∏–≤–µ–Ω. –ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!"
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = self.—Ç–µ–ª–µ–≥—Ä–∞–º.–ø–æ–ª—É—á–∏—Ç—å_–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞, —ç—Ç–æ_–∞–¥–º–∏–Ω(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥))
        elif –¥–∞–Ω–Ω—ã–µ == "–≥–ª–∞–≤–Ω–æ–µ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è":
            —Ç–µ–∫—Å—Ç = "üé® –û–ø–∏—à–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å:"
            self.—Å–æ—Å—Ç–æ—è–Ω–∏—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥] = {"—Å–æ—Å—Ç–æ—è–Ω–∏–µ": "–æ–∂–∏–¥–∞–Ω–∏–µ_–ø—Ä–æ–º–ø—Ç–∞_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"}
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = None
        elif –¥–∞–Ω–Ω—ã–µ == "–≥–ª–∞–≤–Ω–æ–µ_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã":
            —Ç–µ–∫—Å—Ç = "üõ† –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:"
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = self.—Ç–µ–ª–µ–≥—Ä–∞–º.–ø–æ–ª—É—á–∏—Ç—å_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞)
        elif –¥–∞–Ω–Ω—ã–µ == "–≥–ª–∞–≤–Ω–æ–µ_–Ω–∞—Å—Ç—Ä–æ–π–∫–∏":
            —Ç–µ–∫—Å—Ç = "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:"
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = self._–ø–æ–ª—É—á–∏—Ç—å_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É_–Ω–∞—Å—Ç—Ä–æ–µ–∫(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞)
        elif –¥–∞–Ω–Ω—ã–µ == "–≥–ª–∞–≤–Ω–æ–µ_–ø–æ–º–æ—â—å":
            —Ç–µ–∫—Å—Ç = –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–ø–æ–º–æ—â—å", –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞)
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = self.—Ç–µ–ª–µ–≥—Ä–∞–º.–ø–æ–ª—É—á–∏—Ç—å_–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞, —ç—Ç–æ_–∞–¥–º–∏–Ω(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥))
        else:
            —Ç–µ–∫—Å—Ç = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞"
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = None
        
        await self.—Ç–µ–ª–µ–≥—Ä–∞–º.—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å_—Ç–µ–∫—Å—Ç_—Å–æ–æ–±—â–µ–Ω–∏—è(
            –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
            –∏–¥_—Å–æ–æ–±—â–µ–Ω–∏—è=–∏–¥_—Å–æ–æ–±—â–µ–Ω–∏—è,
            —Ç–µ–∫—Å—Ç=—Ç–µ–∫—Å—Ç,
            —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
        )
        
        await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–≤–µ—Ç–∏—Ç—å_–Ω–∞_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å(–∏–¥_–∑–∞–ø—Ä–æ—Å–∞)
    
    def _–ø–æ–ª—É—á–∏—Ç—å_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É_–Ω–∞—Å—Ç—Ä–æ–µ–∫(self, —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: str = "ru") -> Dict[str, Any]:
        """–ü–æ–ª—É—á–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞—Å—Ç—Ä–æ–µ–∫."""
        –∫–Ω–æ–ø–∫–∏ = [
            [
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–Ω–∞—Å—Ç—Ä–æ–π–∫–∏_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"},
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–ø–æ–¥–ø–∏—Å–∫–∞", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–Ω–∞—Å—Ç—Ä–æ–π–∫–∏_–ø–æ–¥–ø–∏—Å–∫–∞"}
            ],
            [
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–Ω–∞–∑–∞–¥", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é"}
            ]
        ]
        
        return self.—Ç–µ–ª–µ–≥—Ä–∞–º.—Å–æ–∑–¥–∞—Ç—å_–∏–Ω–ª–∞–π–Ω_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(–∫–Ω–æ–ø–∫–∏)
    
    async def _–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ_–ª–∏–º–∏—Ç–æ–≤(self, –∏–¥_—á–∞—Ç–∞: int, –ª–∏–º–∏—Ç—ã: Dict, —è–∑—ã–∫: str):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤."""
        —Ç–µ–∫—Å—Ç = –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–ª–∏–º–∏—Ç—ã_–ø—Ä–µ–≤—ã—à–µ–Ω—ã", —è–∑—ã–∫,
                              –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ_—Å–æ–æ–±—â–µ–Ω–∏–π=–ª–∏–º–∏—Ç—ã["–ª–∏–º–∏—Ç—ã"]["—Å–æ–æ–±—â–µ–Ω–∏—è"]["–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ"],
                              –ª–∏–º–∏—Ç_—Å–æ–æ–±—â–µ–Ω–∏–π=–ª–∏–º–∏—Ç—ã["–ª–∏–º–∏—Ç—ã"]["—Å–æ–æ–±—â–µ–Ω–∏—è"]["–ª–∏–º–∏—Ç"],
                              –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π=–ª–∏–º–∏—Ç—ã["–ª–∏–º–∏—Ç—ã"]["–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"]["–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ"],
                              –ª–∏–º–∏—Ç_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π=–ª–∏–º–∏—Ç—ã["–ª–∏–º–∏—Ç—ã"]["–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"]["–ª–∏–º–∏—Ç"])
        
        –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = self.—Ç–µ–ª–µ–≥—Ä–∞–º.–ø–æ–ª—É—á–∏—Ç—å_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É_–ø–æ–¥–ø–∏—Å–∫–∏(—è–∑—ã–∫)
        
        await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
            –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
            —Ç–µ–∫—Å—Ç=—Ç–µ–∫—Å—Ç,
            —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
        )
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–≤–≤–æ–¥_—Å–æ—Å—Ç–æ—è–Ω–∏—è(self, —Ç–µ–∫—Å—Ç: str, —Å–æ—Å—Ç–æ—è–Ω–∏–µ: Dict, —Å–æ–æ–±—â–µ–Ω–∏–µ: Dict, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤–≤–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
        –∏–¥_—á–∞—Ç–∞ = —Å–æ–æ–±—â–µ–Ω–∏–µ["chat"]["id"]
        
        if —Å–æ—Å—Ç–æ—è–Ω–∏–µ["—Å–æ—Å—Ç–æ—è–Ω–∏–µ"] == "–æ–∂–∏–¥–∞–Ω–∏–µ_–ø—Ä–æ–º–ø—Ç–∞_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è":
            await self._—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ(—Ç–µ–∫—Å—Ç, –∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            del self.—Å–æ—Å—Ç–æ—è–Ω–∏—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥]
        elif —Å–æ—Å—Ç–æ—è–Ω–∏–µ["—Å–æ—Å—Ç–æ—è–Ω–∏–µ"] == "–æ–∂–∏–¥–∞–Ω–∏–µ_–≥–æ—Ä–æ–¥–∞_–ø–æ–≥–æ–¥—ã":
            await self._–ø–æ–ª—É—á–∏—Ç—å_–ø–æ–≥–æ–¥—É(—Ç–µ–∫—Å—Ç, –∏–¥_—á–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            del self.—Å–æ—Å—Ç–æ—è–Ω–∏—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π[–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥]
    
    async def _—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ(self, –ø—Ä–æ–º–ø—Ç: str, –∏–¥_—á–∞—Ç–∞: int, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å DALL-E."""
        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã
        –ª–∏–º–∏—Ç—ã = await self.–±–¥.–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ª–∏–º–∏—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥)
        if not –ª–∏–º–∏—Ç—ã["–º–æ–∂–µ—Ç_—Å–æ–∑–¥–∞—Ç—å_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"]:
            await self._–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ_–ª–∏–º–∏—Ç–æ–≤(–∏–¥_—á–∞—Ç–∞, –ª–∏–º–∏—Ç—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞)
            return
        
        await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–∑–∞–≥—Ä—É–∂–∞–µ—Ç_—Ñ–æ—Ç–æ(–∏–¥_—á–∞—Ç–∞)
        
        try:
            # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            —Ä–µ–∑—É–ª—å—Ç–∞—Ç = await self.–æ–ø–µ–Ω–∞–∏.—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ(–ø—Ä–æ–º–ø—Ç, –∏–¥_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è=–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∏–¥)
            
            # –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Ñ–æ—Ç–æ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ñ–æ—Ç–æ=—Ä–µ–∑—É–ª—å—Ç–∞—Ç["—Å—Å—ã–ª–∫–∞"],
                –ø–æ–¥–ø–∏—Å—å=f"üé® **–°–æ–∑–¥–∞–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É:** {–ø—Ä–æ–º–ø—Ç}"
            )
            
            # –û–±–Ω–æ–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
            await self.–±–¥.—É–≤–µ–ª–∏—á–∏—Ç—å_–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥, "–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è", 1)
            
        except Exception as e:
            –ª–æ–≥.error("–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å", –æ—à–∏–±–∫–∞=str(e))
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç=–ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–æ—à–∏–±–∫–∞_–æ–±—â–∞—è", –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.–∫–æ–¥_—è–∑—ã–∫–∞)
            )
    
    async def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∏–Ω–ª–∞–π–Ω_–∑–∞–ø—Ä–æ—Å(self, –∏–Ω–ª–∞–π–Ω_–∑–∞–ø—Ä–æ—Å: Dict[str, Any]):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏–Ω–ª–∞–π–Ω –∑–∞–ø—Ä–æ—Å—ã."""
        # –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω–ª–∞–π–Ω –∑–∞–ø—Ä–æ—Å–æ–≤
        –∏–¥_–∑–∞–ø—Ä–æ—Å–∞ = –∏–Ω–ª–∞–π–Ω_–∑–∞–ø—Ä–æ—Å["id"]
        
        # –ü–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –æ—Ç–≤–µ—á–∞–µ–º –ø—É—Å—Ç—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
        await self.—Ç–µ–ª–µ–≥—Ä–∞–º._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("answerInlineQuery", json={
            "inline_query_id": –∏–¥_–∑–∞–ø—Ä–æ—Å–∞,
            "results": []
        })
    
    # –ù–û–í–´–ï –ò–ù–ù–û–í–ê–¶–ò–û–ù–ù–´–ï –ú–ï–¢–û–î–´
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ñ—É–Ω–∫—Ü–∏—é_–∫–æ–ª–±–µ–∫(self, –ø–∞—Ä–∞–º–µ—Ç—Ä: str, –∏–¥_—á–∞—Ç–∞: int, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏."""
        if –ø–∞—Ä–∞–º–µ—Ç—Ä == "—á–∞—Ç":
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç="üí¨ **–£–º–Ω—ã–π —á–∞—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!**\n\n–¢–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å, –∏ —è –æ—Ç–≤–µ—á—É —Å –ø–æ–º–æ—â—å—é GPT-4o!"
            )
        elif –ø–∞—Ä–∞–º–µ—Ç—Ä == "–∞—Ä—Ç":
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç="üé® **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≥–æ—Ç–æ–≤!**\n\n–û–ø–∏—à–∏—Ç–µ —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å, –∏ —è –Ω–∞—Ä–∏—Å—É—é —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é DALL-E 3!\n\n–ü—Ä–∏–º–µ—Ä: '–ù–∞—Ä–∏—Å—É–π –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ—Ç–∞ –≤ —Å—Ç–∏–ª–µ Van Gogh'"
            )
        elif –ø–∞—Ä–∞–º–µ—Ç—Ä == "–∞–Ω–∞–ª–∏–∑":
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç="üëÅÔ∏è **–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!**\n\n–û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ –ª—é–±–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∏ —è –ø–æ–¥—Ä–æ–±–Ω–æ –µ–≥–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É—é!"
            )
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–ø–µ—Ä—Å–æ–Ω—ã_–∫–æ–ª–±–µ–∫(self, –ø–∞—Ä–∞–º–µ—Ç—Ä: str, –∏–¥_—á–∞—Ç–∞: int, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å AI –ø–µ—Ä—Å–æ–Ω—ã."""
        if –ø–∞—Ä–∞–º–µ—Ç—Ä == "–º–µ–Ω—é":
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = {
                "inline_keyboard": [
                    [
                        {"text": "üß† –≠–π–Ω—à—Ç–µ–π–Ω", "callback_data": "–ø–µ—Ä—Å–æ–Ω–∞:—ç–π–Ω—à—Ç–µ–π–Ω"},
                        {"text": "üé® –¥–∞ –í–∏–Ω—á–∏", "callback_data": "–ø–µ—Ä—Å–æ–Ω–∞:–¥–∞–≤–∏–Ω—á–∏"}
                    ],
                    [
                        {"text": "üíº –°—Ç–∏–≤ –î–∂–æ–±—Å", "callback_data": "–ø–µ—Ä—Å–æ–Ω–∞:–¥–∂–æ–±—Å"},
                        {"text": "üßô‚Äç‚ôÇÔ∏è –°–æ–∫—Ä–∞—Ç", "callback_data": "–ø–µ—Ä—Å–æ–Ω–∞:—Å–æ–∫—Ä–∞—Ç"}
                    ],
                    [
                        {"text": "üë®‚Äçüç≥ –ì–æ—Ä–¥–æ–Ω –†–∞–º–∑–∏", "callback_data": "–ø–µ—Ä—Å–æ–Ω–∞:–ø–æ–≤–∞—Ä"},
                        {"text": "üé≠ –®–µ–∫—Å–ø–∏—Ä", "callback_data": "–ø–µ—Ä—Å–æ–Ω–∞:—à–µ–∫—Å–ø–∏—Ä"}
                    ],
                    [
                        {"text": "üîô –ù–∞–∑–∞–¥", "callback_data": "—Ñ—É–Ω–∫—Ü–∏—è:–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é"}
                    ]
                ]
            }
            
            —Ç–µ–∫—Å—Ç = "üßô‚Äç‚ôÇÔ∏è **AI –ü–ï–†–°–û–ù–´**\n\n" \
                   "–í—ã–±–µ—Ä–∏—Ç–µ —Å –∫–µ–º —Ö–æ—Ç–∏—Ç–µ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å:\n\n" \
                   "üß† **–≠–π–Ω—à—Ç–µ–π–Ω** - –ì–µ–Ω–∏–∞–ª—å–Ω—ã–π —Ñ–∏–∑–∏–∫\n" \
                   "üé® **–¥–∞ –í–∏–Ω—á–∏** - –í–µ–ª–∏–∫–∏–π —Ö—É–¥–æ–∂–Ω–∏–∫\n" \
                   "üíº **–î–∂–æ–±—Å** - –í–∏–∑–∏–æ–Ω–µ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π\n" \
                   "üßô‚Äç‚ôÇÔ∏è **–°–æ–∫—Ä–∞—Ç** - –ú—É–¥—Ä—ã–π —Ñ–∏–ª–æ—Å–æ—Ñ\n" \
                   "üë®‚Äçüç≥ **–†–∞–º–∑–∏** - –®–µ—Ñ-–ø–æ–≤–∞—Ä\n" \
                   "üé≠ **–®–µ–∫—Å–ø–∏—Ä** - –í–µ–ª–∏–∫–∏–π –¥—Ä–∞–º–∞—Ç—É—Ä–≥"
            
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç=—Ç–µ–∫—Å—Ç,
                —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
            )
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã_–∫–æ–ª–±–µ–∫(self, –ø–∞—Ä–∞–º–µ—Ç—Ä: str, –∏–¥_—á–∞—Ç–∞: int, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã."""
        if –ø–∞—Ä–∞–º–µ—Ç—Ä == "–º–µ–Ω—é":
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = {
                "inline_keyboard": [
                    [
                        {"text": "üå§Ô∏è –ü–æ–≥–æ–¥–∞", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:–ø–æ–≥–æ–¥–∞"},
                        {"text": "üìö Wikipedia", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:–≤–∏–∫–∏"}
                    ],
                    [
                        {"text": "üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä"},
                        {"text": "üî§ –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫"}
                    ],
                    [
                        {"text": "‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è"},
                        {"text": "üìä QR-–∫–æ–¥", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:qr"}
                    ],
                    [
                        {"text": "üîô –ù–∞–∑–∞–¥", "callback_data": "—Ñ—É–Ω–∫—Ü–∏—è:–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é"}
                    ]
                ]
            }
            
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç="üõ†Ô∏è **–£–ú–ù–´–ï –ò–ù–°–¢–†–£–ú–ï–ù–¢–´**\n\n–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:",
                —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
            )
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–∏–≥—Ä—ã_–∫–æ–ª–±–µ–∫(self, –ø–∞—Ä–∞–º–µ—Ç—Ä: str, –∏–¥_—á–∞—Ç–∞: int, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏–≥—Ä—ã."""
        if –ø–∞—Ä–∞–º–µ—Ç—Ä == "–º–µ–Ω—é":
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = {
                "inline_keyboard": [
                    [
                        {"text": "üîÆ –ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∫–≤–µ—Å—Ç", "callback_data": "–∏–≥—Ä–∞:–∫–≤–µ—Å—Ç"},
                        {"text": "üß© –ó–∞–≥–∞–¥–∫–∏", "callback_data": "–∏–≥—Ä–∞:–∑–∞–≥–∞–¥–∫–∏"}
                    ],
                    [
                        {"text": "üìö –°–æ–∑–¥–∞–π –∏—Å—Ç–æ—Ä–∏—é", "callback_data": "–∏–≥—Ä–∞:–∏—Å—Ç–æ—Ä–∏—è"},
                        {"text": "üé≠ –†–æ–ª–µ–≤–∞—è –∏–≥—Ä–∞", "callback_data": "–∏–≥—Ä–∞:—Ä–æ–ª—å"}
                    ],
                    [
                        {"text": "üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ", "callback_data": "–∏–≥—Ä–∞:—á–∏—Å–ª–æ"},
                        {"text": "üèôÔ∏è –ì–æ—Ä–æ–¥–∞", "callback_data": "–∏–≥—Ä–∞:–≥–æ—Ä–æ–¥–∞"}
                    ],
                    [
                        {"text": "üîô –ù–∞–∑–∞–¥", "callback_data": "—Ñ—É–Ω–∫—Ü–∏—è:–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é"}
                    ]
                ]
            }
            
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç="üéÆ **–ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ï –ò–ì–†–´**\n\n–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É:",
                —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
            )
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–ø—Ä–µ–º–∏—É–º_–∫–æ–ª–±–µ–∫(self, –ø–∞—Ä–∞–º–µ—Ç—Ä: str, –∏–¥_—á–∞—Ç–∞: int, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏."""
        if –ø–∞—Ä–∞–º–µ—Ç—Ä == "—Ç–∞—Ä–∏—Ñ—ã":
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = {
                "inline_keyboard": [
                    [
                        {"text": "üî• –ë–ê–ó–û–í–´–ô - 199‚ÇΩ", "callback_data": "–∫—É–ø–∏—Ç—å:–±–∞–∑–æ–≤—ã–π"}
                    ],
                    [
                        {"text": "‚ö° –ü–†–û - 399‚ÇΩ", "callback_data": "–∫—É–ø–∏—Ç—å:–ø—Ä–æ"}
                    ],
                    [
                        {"text": "üëë –≠–õ–ò–¢ - 799‚ÇΩ", "callback_data": "–∫—É–ø–∏—Ç—å:—ç–ª–∏—Ç"}
                    ],
                    [
                        {"text": "üéÅ –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥", "callback_data": "–ø—Ä–µ–º–∏—É–º:–ø—Ä–æ–±–Ω—ã–π"}
                    ],
                    [
                        {"text": "üîô –ù–∞–∑–∞–¥", "callback_data": "—Ñ—É–Ω–∫—Ü–∏—è:–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é"}
                    ]
                ]
            }
            
            —Ç–µ–∫—Å—Ç = "üíé **–ü–†–ï–ú–ò–£–ú –¢–ê–†–ò–§–´**\n\n" \
                   "üî• **–ë–ê–ó–û–í–´–ô (199‚ÇΩ/–º–µ—Å)**\n" \
                   "‚Ä¢ 1000 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å\n" \
                   "‚Ä¢ 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–¥–µ–Ω—å\n" \
                   "‚Ä¢ –ë–∞–∑–æ–≤—ã–µ AI –ø–µ—Ä—Å–æ–Ω—ã\n\n" \
                   "‚ö° **–ü–†–û (399‚ÇΩ/–º–µ—Å)**\n" \
                   "‚Ä¢ –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è\n" \
                   "‚Ä¢ 200 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–¥–µ–Ω—å\n" \
                   "‚Ä¢ –í—Å–µ AI –ø–µ—Ä—Å–æ–Ω—ã\n" \
                   "‚Ä¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞\n\n" \
                   "üëë **–≠–õ–ò–¢ (799‚ÇΩ/–º–µ—Å)**\n" \
                   "‚Ä¢ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ü–†–û\n" \
                   "‚Ä¢ –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n" \
                   "‚Ä¢ –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –ø–µ—Ä—Å–æ–Ω—ã\n" \
                   "‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞"
            
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç=—Ç–µ–∫—Å—Ç,
                —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
            )
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É_–∫–æ–ª–±–µ–∫(self, –ø–∞—Ä–∞–º–µ—Ç—Ä: str, –∏–¥_—á–∞—Ç–∞: int, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É."""
        if –ø–∞—Ä–∞–º–µ—Ç—Ä == "–º–æ–π":
            # –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ = await self.–±–¥.–ø–æ–ª—É—á–∏—Ç—å_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.—Ç–µ–ª–µ–≥—Ä–∞–º_–∏–¥)
            
            —Ç–µ–∫—Å—Ç = f"üìä **–í–ê–®–ê –°–¢–ê–¢–ò–°–¢–ò–ö–ê**\n\n" \
                   f"üí¨ –°–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.get('—Å–æ–æ–±—â–µ–Ω–∏—è', 0)}\n" \
                   f"üé® –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–Ω–æ: {—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.get('–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è', 0)}\n" \
                   f"üîä –ì–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π: {—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.get('–≥–æ–ª–æ—Å', 0)}\n" \
                   f"üìÖ –î–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: {—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.get('–¥–Ω–∏_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏', 0)}\n" \
                   f"‚≠ê –£—Ä–æ–≤–µ–Ω—å: {—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.get('—É—Ä–æ–≤–µ–Ω—å', 1)}\n" \
                   f"üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–π: {—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.get('–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è', 0)}"
            
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç=—Ç–µ–∫—Å—Ç
            )
    
    async def _–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–Ω–∞—Å—Ç—Ä–æ–π–∫–∏_–∫–æ–ª–±–µ–∫(self, –ø–∞—Ä–∞–º–µ—Ç—Ä: str, –∏–¥_—á–∞—Ç–∞: int, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å):
        """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏."""
        if –ø–∞—Ä–∞–º–µ—Ç—Ä == "–º–µ–Ω—é":
            –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ = {
                "inline_keyboard": [
                    [
                        {"text": "üåç –Ø–∑—ã–∫", "callback_data": "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞:—è–∑—ã–∫"},
                        {"text": "üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è", "callback_data": "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞:—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"}
                    ],
                    [
                        {"text": "üé® –¢–µ–º–∞", "callback_data": "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞:—Ç–µ–º–∞"},
                        {"text": "üîí –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å", "callback_data": "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞:–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å"}
                    ],
                    [
                        {"text": "üîô –ù–∞–∑–∞–¥", "callback_data": "—Ñ—É–Ω–∫—Ü–∏—è:–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é"}
                    ]
                ]
            }
            
            await self.—Ç–µ–ª–µ–≥—Ä–∞–º.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                —Ç–µ–∫—Å—Ç="‚öôÔ∏è **–ù–ê–°–¢–†–û–ô–ö–ò**\n\n–í—ã–±–µ—Ä–∏—Ç–µ —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:",
                —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
            )
