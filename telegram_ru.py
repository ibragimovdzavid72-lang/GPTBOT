"""–†—É—Å—Å–∫–∏–π Telegram API –ö–ª–∏–µ–Ω—Ç"""

import asyncio
import json
import time
from io import BytesIO
from typing import Any, Dict, List, Optional, Union
from urllib.parse import urljoin

import httpx
import structlog
from config_ru import –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç

–ª–æ–≥ = structlog.get_logger("—Ç–µ–ª–µ–≥—Ä–∞–º")


class –û—à–∏–±–∫–∞–¢–µ–ª–µ–≥—Ä–∞–º–ê–ü–ò(Exception):
    """–û—à–∏–±–∫–∞ Telegram API."""
    pass


class –¢–µ–ª–µ–≥—Ä–∞–º–ö–ª–∏–µ–Ω—Ç:
    """–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä—É—Å—Å–∫–∏–π Telegram Bot API –∫–ª–∏–µ–Ω—Ç."""
    
    def __init__(self, —Ç–æ–∫–µ–Ω_–±–æ—Ç–∞: str, –º–µ–Ω–µ–¥–∂–µ—Ä_–±–¥=None):
        self.—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞ = —Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
        self.–º–µ–Ω–µ–¥–∂–µ—Ä_–±–¥ = –º–µ–Ω–µ–¥–∂–µ—Ä_–±–¥
        self.–±–∞–∑–æ–≤–∞—è_—Å—Å—ã–ª–∫–∞ = f"https://api.telegram.org/bot{—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞}/"
        
        # HTTP –∫–ª–∏–µ–Ω—Ç —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏ –∏ —Ç–∞–π–º–∞—É—Ç–∞–º–∏
        self.http_–∫–ª–∏–µ–Ω—Ç = httpx.AsyncClient(
            timeout=httpx.Timeout(–Ω–∞—Å—Ç—Ä–æ–π–∫–∏.—Ç–µ–ª–µ–≥—Ä–∞–º.—Ç–∞–π–º–∞—É—Ç),
            limits=httpx.Limits(max_connections=–Ω–∞—Å—Ç—Ä–æ–π–∫–∏.—Ç–µ–ª–µ–≥—Ä–∞–º.–º–∞–∫—Å_—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π)
        )
        
        # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
        self._–≤—Ä–µ–º—è_–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ_–∑–∞–ø—Ä–æ—Å–∞ = 0
        self._—Å—á–µ—Ç—á–∏–∫_–∑–∞–ø—Ä–æ—Å–æ–≤ = 0
        self._–æ–∫–Ω–æ_–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è_—Å–∫–æ—Ä–æ—Å—Ç–∏ = 60  # —Å–µ–∫—É–Ω–¥—ã
        self._–º–∞–∫—Å_–∑–∞–ø—Ä–æ—Å–æ–≤_–≤_–º–∏–Ω—É—Ç—É = 30
    
    async def –∑–∞–∫—Ä—ã—Ç—å(self):
        """–ó–∞–∫—Ä—ã—Ç—å HTTP –∫–ª–∏–µ–Ω—Ç."""
        await self.http_–∫–ª–∏–µ–Ω—Ç.aclose()
    
    async def _—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å(self, –º–µ—Ç–æ–¥: str, **kwargs) -> Dict[str, Any]:
        """–°–¥–µ–ª–∞—Ç—å API –∑–∞–ø—Ä–æ—Å —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫."""
        await self._–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å_—Å–∫–æ—Ä–æ—Å—Ç—å()
        
        —Å—Å—ã–ª–∫–∞ = urljoin(self.–±–∞–∑–æ–≤–∞—è_—Å—Å—ã–ª–∫–∞, –º–µ—Ç–æ–¥)
        
        for –ø–æ–ø—ã—Ç–∫–∞ in range(3):  # –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –¥–æ 3 —Ä–∞–∑
            try:
                –æ—Ç–≤–µ—Ç = await self.http_–∫–ª–∏–µ–Ω—Ç.post(—Å—Å—ã–ª–∫–∞, **kwargs)
                
                if –æ—Ç–≤–µ—Ç.status_code == 200:
                    –¥–∞–Ω–Ω—ã–µ = –æ—Ç–≤–µ—Ç.json()
                    if –¥–∞–Ω–Ω—ã–µ.get("ok"):
                        return –¥–∞–Ω–Ω—ã–µ["result"]
                    else:
                        –∫–æ–¥_–æ—à–∏–±–∫–∏ = –¥–∞–Ω–Ω—ã–µ.get("error_code", 0)
                        –æ–ø–∏—Å–∞–Ω–∏–µ = –¥–∞–Ω–Ω—ã–µ.get("description", "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞")
                        
                        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫
                        if –∫–æ–¥_–æ—à–∏–±–∫–∏ == 429:  # –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤
                            –ø–æ–≤—Ç–æ—Ä–∏—Ç—å_—á–µ—Ä–µ–∑ = –¥–∞–Ω–Ω—ã–µ.get("parameters", {}).get("retry_after", 1)
                            –ª–æ–≥.warning("–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏, –æ–∂–∏–¥–∞–Ω–∏–µ", –ø–æ–≤—Ç–æ—Ä–∏—Ç—å_—á–µ—Ä–µ–∑=–ø–æ–≤—Ç–æ—Ä–∏—Ç—å_—á–µ—Ä–µ–∑)
                            await asyncio.sleep(–ø–æ–≤—Ç–æ—Ä–∏—Ç—å_—á–µ—Ä–µ–∑)
                            continue
                        
                        raise –û—à–∏–±–∫–∞–¢–µ–ª–µ–≥—Ä–∞–º–ê–ü–ò(f"API –û—à–∏–±–∫–∞ {–∫–æ–¥_–æ—à–∏–±–∫–∏}: {–æ–ø–∏—Å–∞–Ω–∏–µ}")
                else:
                    –ª–æ–≥.error("HTTP –æ—à–∏–±–∫–∞", —Å—Ç–∞—Ç—É—Å_–∫–æ–¥=–æ—Ç–≤–µ—Ç.status_code, —Ç–µ–∫—Å—Ç=–æ—Ç–≤–µ—Ç.text)
                    raise –û—à–∏–±–∫–∞–¢–µ–ª–µ–≥—Ä–∞–º–ê–ü–ò(f"HTTP {–æ—Ç–≤–µ—Ç.status_code}: {–æ—Ç–≤–µ—Ç.text}")
                    
            except httpx.TimeoutException:
                –ª–æ–≥.warning("–¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞", –ø–æ–ø—ã—Ç–∫–∞=–ø–æ–ø—ã—Ç–∫–∞ + 1)
                if –ø–æ–ø—ã—Ç–∫–∞ == 2:  # –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞
                    raise –û—à–∏–±–∫–∞–¢–µ–ª–µ–≥—Ä–∞–º–ê–ü–ò("–¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞")
                await asyncio.sleep(2 ** –ø–æ–ø—ã—Ç–∫–∞)  # –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
                
            except Exception as e:
                –ª–æ–≥.error("–ó–∞–ø—Ä–æ—Å –Ω–µ —É–¥–∞–ª—Å—è", –æ—à–∏–±–∫–∞=str(e), –ø–æ–ø—ã—Ç–∫–∞=–ø–æ–ø—ã—Ç–∫–∞ + 1)
                if –ø–æ–ø—ã—Ç–∫–∞ == 2:  # –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞
                    raise
                await asyncio.sleep(2 ** –ø–æ–ø—ã—Ç–∫–∞)
    
    async def _–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å_—Å–∫–æ—Ä–æ—Å—Ç—å(self):
        """–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏."""
        —Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è = time.time()
        
        # –°–±—Ä–æ—Å–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –µ—Å–ª–∏ –æ–∫–Ω–æ –ø—Ä–æ—à–ª–æ
        if —Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è - self._–≤—Ä–µ–º—è_–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ_–∑–∞–ø—Ä–æ—Å–∞ > self._–æ–∫–Ω–æ_–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è_—Å–∫–æ—Ä–æ—Å—Ç–∏:
            self._—Å—á–µ—Ç—á–∏–∫_–∑–∞–ø—Ä–æ—Å–æ–≤ = 0
            self._–≤—Ä–µ–º—è_–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ_–∑–∞–ø—Ä–æ—Å–∞ = —Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è
        
        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω—É–∂–Ω–æ –ª–∏ –∂–¥–∞—Ç—å
        if self._—Å—á–µ—Ç—á–∏–∫_–∑–∞–ø—Ä–æ—Å–æ–≤ >= self._–º–∞–∫—Å_–∑–∞–ø—Ä–æ—Å–æ–≤_–≤_–º–∏–Ω—É—Ç—É:
            –≤—Ä–µ–º—è_—Å–Ω–∞ = self._–æ–∫–Ω–æ_–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è_—Å–∫–æ—Ä–æ—Å—Ç–∏ - (—Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è - self._–≤—Ä–µ–º—è_–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ_–∑–∞–ø—Ä–æ—Å–∞)
            if –≤—Ä–µ–º—è_—Å–Ω–∞ > 0:
                –ª–æ–≥.info("–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∞–∫—Ç–∏–≤–Ω–æ", –≤—Ä–µ–º—è_—Å–Ω–∞=–≤—Ä–µ–º—è_—Å–Ω–∞)
                await asyncio.sleep(–≤—Ä–µ–º—è_—Å–Ω–∞)
                self._—Å—á–µ—Ç—á–∏–∫_–∑–∞–ø—Ä–æ—Å–æ–≤ = 0
                self._–≤—Ä–µ–º—è_–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ_–∑–∞–ø—Ä–æ—Å–∞ = time.time()
        
        self._—Å—á–µ—Ç—á–∏–∫_–∑–∞–ø—Ä–æ—Å–æ–≤ += 1
    
    # –û—Å–Ω–æ–≤–Ω—ã–µ API –º–µ—Ç–æ–¥—ã
    async def —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å_–≤–µ–±—Ö—É–∫(self, —Å—Å—ã–ª–∫–∞: str, —Å–µ–∫—Ä–µ—Ç–Ω—ã–π_—Ç–æ–∫–µ–Ω: Optional[str] = None) -> bool:
        """–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –≤–µ–±—Ö—É–∫–∞."""
        –ø–∞—Ä–∞–º–µ—Ç—Ä—ã = {"url": —Å—Å—ã–ª–∫–∞}
        if —Å–µ–∫—Ä–µ—Ç–Ω—ã–π_—Ç–æ–∫–µ–Ω:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["secret_token"] = —Å–µ–∫—Ä–µ—Ç–Ω—ã–π_—Ç–æ–∫–µ–Ω
        
        —Ä–µ–∑—É–ª—å—Ç–∞—Ç = await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("setWebhook", json=–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
        return True
    
    # –ú–µ—Ç–æ–¥—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
    async def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
        self,
        –∏–¥_—á–∞—Ç–∞: Union[int, str],
        —Ç–µ–∫—Å—Ç: str,
        —Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏: Optional[str] = "HTML",
        –æ—Ç–∫–ª—é—á–∏—Ç—å_–ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä_–≤–µ–±_—Å—Ç—Ä–∞–Ω–∏—Ü: bool = True,
        –æ—Ç–∫–ª—é—á–∏—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: bool = False,
        –æ—Ç–≤–µ—Ç_–Ω–∞_—Å–æ–æ–±—â–µ–Ω–∏–µ_–∏–¥: Optional[int] = None,
        —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞: Optional[Dict] = None
    ) -> Dict[str, Any]:
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ."""
        # –†–∞–∑–¥–µ–ª–∏—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        if len(—Ç–µ–∫—Å—Ç) > 4096:
            —Å–æ–æ–±—â–µ–Ω–∏—è = []
            for i in range(0, len(—Ç–µ–∫—Å—Ç), 4096):
                —á–∞—Å—Ç—å = —Ç–µ–∫—Å—Ç[i:i+4096]
                —Å–æ–æ–±—â–µ–Ω–∏–µ = await self.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(
                    –∏–¥_—á–∞—Ç–∞=–∏–¥_—á–∞—Ç–∞,
                    —Ç–µ–∫—Å—Ç=—á–∞—Å—Ç—å,
                    —Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏=—Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏,
                    –æ—Ç–∫–ª—é—á–∏—Ç—å_–ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä_–≤–µ–±_—Å—Ç—Ä–∞–Ω–∏—Ü=–æ—Ç–∫–ª—é—á–∏—Ç—å_–ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä_–≤–µ–±_—Å—Ç—Ä–∞–Ω–∏—Ü,
                    –æ—Ç–∫–ª—é—á–∏—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ=–æ—Ç–∫–ª—é—á–∏—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ,
                    –æ—Ç–≤–µ—Ç_–Ω–∞_—Å–æ–æ–±—â–µ–Ω–∏–µ_–∏–¥=–æ—Ç–≤–µ—Ç_–Ω–∞_—Å–æ–æ–±—â–µ–Ω–∏–µ_–∏–¥ if i == 0 else None,
                    —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞=—Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞ if i == 0 else None
                )
                —Å–æ–æ–±—â–µ–Ω–∏—è.append(—Å–æ–æ–±—â–µ–Ω–∏–µ)
            return —Å–æ–æ–±—â–µ–Ω–∏—è[0]  # –í–µ—Ä–Ω—É—Ç—å –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        
        –ø–∞—Ä–∞–º–µ—Ç—Ä—ã = {
            "chat_id": –∏–¥_—á–∞—Ç–∞,
            "text": —Ç–µ–∫—Å—Ç,
            "parse_mode": —Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏,
            "disable_web_page_preview": –æ—Ç–∫–ª—é—á–∏—Ç—å_–ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä_–≤–µ–±_—Å—Ç—Ä–∞–Ω–∏—Ü,
            "disable_notification": –æ—Ç–∫–ª—é—á–∏—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        }
        
        if –æ—Ç–≤–µ—Ç_–Ω–∞_—Å–æ–æ–±—â–µ–Ω–∏–µ_–∏–¥:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["reply_to_message_id"] = –æ—Ç–≤–µ—Ç_–Ω–∞_—Å–æ–æ–±—â–µ–Ω–∏–µ_–∏–¥
        
        if —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["reply_markup"] = —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞
        
        return await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("sendMessage", json=–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
    
    async def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Ñ–æ—Ç–æ(
        self,
        –∏–¥_—á–∞—Ç–∞: Union[int, str],
        —Ñ–æ—Ç–æ: Union[str, BytesIO, bytes],
        –ø–æ–¥–ø–∏—Å—å: Optional[str] = None,
        —Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏: Optional[str] = "HTML",
        –æ—Ç–≤–µ—Ç_–Ω–∞_—Å–æ–æ–±—â–µ–Ω–∏–µ_–∏–¥: Optional[int] = None,
        —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞: Optional[Dict] = None
    ) -> Dict[str, Any]:
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ."""
        –ø–∞—Ä–∞–º–µ—Ç—Ä—ã = {
            "chat_id": –∏–¥_—á–∞—Ç–∞,
            "parse_mode": —Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏
        }
        
        if –ø–æ–¥–ø–∏—Å—å:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["caption"] = –ø–æ–¥–ø–∏—Å—å
        if –æ—Ç–≤–µ—Ç_–Ω–∞_—Å–æ–æ–±—â–µ–Ω–∏–µ_–∏–¥:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["reply_to_message_id"] = –æ—Ç–≤–µ—Ç_–Ω–∞_—Å–æ–æ–±—â–µ–Ω–∏–µ_–∏–¥
        if —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["reply_markup"] = json.dumps(—Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞)
        
        # –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Ñ–æ—Ç–æ
        if isinstance(—Ñ–æ—Ç–æ, str):
            # URL –∏–ª–∏ file_id
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["photo"] = —Ñ–æ—Ç–æ
            return await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("sendPhoto", data=–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
        else:
            # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
            if isinstance(—Ñ–æ—Ç–æ, bytes):
                —Ñ–æ—Ç–æ = BytesIO(—Ñ–æ—Ç–æ)
            
            —Ñ–∞–π–ª—ã = {"photo": ("—Ñ–æ—Ç–æ.jpg", —Ñ–æ—Ç–æ, "image/jpeg")}
            return await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("sendPhoto", data=–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, files=—Ñ–∞–π–ª—ã)
    
    # –ú–µ—Ç–æ–¥—ã –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    def —Å–æ–∑–¥–∞—Ç—å_–∏–Ω–ª–∞–π–Ω_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(self, –∫–Ω–æ–ø–∫–∏: List[List[Dict[str, str]]]) -> Dict[str, Any]:
        """–°–æ–∑–¥–∞—Ç—å —Ä–∞–∑–º–µ—Ç–∫—É –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã."""
        return {
            "inline_keyboard": –∫–Ω–æ–ø–∫–∏
        }
    
    def –ø–æ–ª—É—á–∏—Ç—å_–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(self, —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: str = "ru", —ç—Ç–æ_–∞–¥–º–∏–Ω: bool = False) -> Dict[str, Any]:
        """–ü–æ–ª—É—á–∏—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é - –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø."""
        –∫–Ω–æ–ø–∫–∏ = [
            [
                {"text": "üí¨ –£–º–Ω—ã–π —á–∞—Ç", "callback_data": "—Ñ—É–Ω–∫—Ü–∏—è:—á–∞—Ç"},
                {"text": "üé® –°–æ–∑–¥–∞—Ç—å –∞—Ä—Ç", "callback_data": "—Ñ—É–Ω–∫—Ü–∏—è:–∞—Ä—Ç"}
            ],
            [
                {"text": "üßô‚Äç‚ôÇÔ∏è AI –ü–µ—Ä—Å–æ–Ω—ã", "callback_data": "–ø–µ—Ä—Å–æ–Ω—ã:–º–µ–Ω—é"},
                {"text": "üëÅÔ∏è –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ", "callback_data": "—Ñ—É–Ω–∫—Ü–∏—è:–∞–Ω–∞–ª–∏–∑"}
            ],
            [
                {"text": "üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:–º–µ–Ω—é"},
                {"text": "üéÆ –ò–≥—Ä—ã", "callback_data": "–∏–≥—Ä—ã:–º–µ–Ω—é"}
            ],
            [
                {"text": "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", "callback_data": "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:–º–æ–π"},
                {"text": "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏", "callback_data": "–Ω–∞—Å—Ç—Ä–æ–π–∫–∏:–º–µ–Ω—é"}
            ]
        ]
        
        # –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–º–∏—É–º –∫–Ω–æ–ø–∫—É
        –∫–Ω–æ–ø–∫–∏.append([
            {"text": "üíé –ü—Ä–µ–º–∏—É–º", "callback_data": "–ø—Ä–µ–º–∏—É–º:—Ç–∞—Ä–∏—Ñ—ã"}
        ])
        
        # –ê–¥–º–∏–Ω –∫–Ω–æ–ø–∫–∏
        if —ç—Ç–æ_–∞–¥–º–∏–Ω:
            –∫–Ω–æ–ø–∫–∏.append([
                {"text": "üõ°Ô∏è –ê–¥–º–∏–Ω", "callback_data": "–∞–¥–º–∏–Ω:–º–µ–Ω—é"}
            ])
        
        return {
            "inline_keyboard": –∫–Ω–æ–ø–∫–∏
        }
    
    def –ø–æ–ª—É—á–∏—Ç—å_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤(self, —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: str = "ru") -> Dict[str, Any]:
        """–ü–æ–ª—É—á–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤."""
        –∫–Ω–æ–ø–∫–∏ = [
            [
                {"text": "üå§Ô∏è –ü–æ–≥–æ–¥–∞", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–ø–æ–≥–æ–¥–∞"},
                {"text": "üìö Wikipedia", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–≤–∏–∫–∏"}
            ],
            [
                {"text": "üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä"},
                {"text": "üî§ –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫"}
            ],
            [
                {"text": "‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è"},
                {"text": "üìä QR-–∫–æ–¥", "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_qr"}
            ],
            [
                {"text": "üîô –ù–∞–∑–∞–¥", "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é"}
            ]
        ]
        
        return {
            "inline_keyboard": –∫–Ω–æ–ø–∫–∏
        }
    
    def –ø–æ–ª—É—á–∏—Ç—å_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É_–ø–æ–¥–ø–∏—Å–∫–∏(self, —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: str = "ru") -> Dict[str, Any]:
        """–ü–æ–ª—É—á–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –ø–æ–¥–ø–∏—Å–∫–∏."""
        –∫–Ω–æ–ø–∫–∏ = [
            [
                {"text": "üíé –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∞—Ä–∏—Ñ—ã", "callback_data": "–ø—Ä–µ–º–∏—É–º:—Ç–∞—Ä–∏—Ñ—ã"}
            ],
            [
                {"text": "üîô –ù–∞–∑–∞–¥", "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é"}
            ]
        ]
        
        return {
            "inline_keyboard": –∫–Ω–æ–ø–∫–∏
        }
    
    # –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –æ–ø—ã—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    
    async def –ø–µ—á–∞—Ç–∞–µ—Ç(self, –∏–¥_—á–∞—Ç–∞: Union[int, str]):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ '–ø–µ—á–∞—Ç–∞–µ—Ç'."""
        await self.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–¥–µ–π—Å—Ç–≤–∏–µ_—á–∞—Ç–∞(–∏–¥_—á–∞—Ç–∞, "typing")
    
    async def –∑–∞–≥—Ä—É–∂–∞–µ—Ç_—Ñ–æ—Ç–æ(self, –∏–¥_—á–∞—Ç–∞: Union[int, str]):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ '–∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ'."""
        await self.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–¥–µ–π—Å—Ç–≤–∏–µ_—á–∞—Ç–∞(–∏–¥_—á–∞—Ç–∞, "upload_photo")
    
    async def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–¥–µ–π—Å—Ç–≤–∏–µ_—á–∞—Ç–∞(self, –∏–¥_—á–∞—Ç–∞: Union[int, str], –¥–µ–π—Å—Ç–≤–∏–µ: str):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –≤ —á–∞—Ç."""
        await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("sendChatAction", json={
            "chat_id": –∏–¥_—á–∞—Ç–∞,
            "action": –¥–µ–π—Å—Ç–≤–∏–µ
        })
    
    async def —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å_—Ç–µ–∫—Å—Ç_—Å–æ–æ–±—â–µ–Ω–∏—è(
        self,
        –∏–¥_—á–∞—Ç–∞: Union[int, str],
        –∏–¥_—Å–æ–æ–±—â–µ–Ω–∏—è: int,
        —Ç–µ–∫—Å—Ç: str,
        —Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏: Optional[str] = "HTML",
        —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞: Optional[Dict] = None
    ):
        """–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è."""
        –ø–∞—Ä–∞–º–µ—Ç—Ä—ã = {
            "chat_id": –∏–¥_—á–∞—Ç–∞,
            "message_id": –∏–¥_—Å–æ–æ–±—â–µ–Ω–∏—è,
            "text": —Ç–µ–∫—Å—Ç,
            "parse_mode": —Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏
        }
        
        if —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["reply_markup"] = —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞
        
        return await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("editMessageText", json=–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
    
    async def –æ—Ç–≤–µ—Ç–∏—Ç—å_–Ω–∞_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å(
        self,
        –∏–¥_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å–∞: str,
        —Ç–µ–∫—Å—Ç: Optional[str] = None,
        –ø–æ–∫–∞–∑–∞—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: bool = False
    ):
        """–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –∫–æ–ª–±–µ–∫ –∑–∞–ø—Ä–æ—Å."""
        –ø–∞—Ä–∞–º–µ—Ç—Ä—ã = {
            "callback_query_id": –∏–¥_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å–∞,
            "show_alert": –ø–æ–∫–∞–∑–∞—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        }
        
        if —Ç–µ–∫—Å—Ç:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["text"] = —Ç–µ–∫—Å—Ç
        
        return await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("answerCallbackQuery", json=–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
    
    def –ø–æ–ª—É—á–∏—Ç—å_–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(self, —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: str = "ru", —ç—Ç–æ_–∞–¥–º–∏–Ω: bool = False) -> Dict[str, Any]:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é."""
        –∫–Ω–æ–ø–∫–∏ = [
            [
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_—á–∞—Ç", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_—á–∞—Ç"},
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"}
            ],
            [
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–≥–æ–ª–æ—Å", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–≥–æ–ª–æ—Å"},
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã"}
            ],
            [
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–Ω–∞—Å—Ç—Ä–æ–π–∫–∏", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–Ω–∞—Å—Ç—Ä–æ–π–∫–∏"},
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–ø–æ–º–æ—â—å", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–ø–æ–º–æ—â—å"}
            ]
        ]
        
        if —ç—Ç–æ_–∞–¥–º–∏–Ω:
            –∫–Ω–æ–ø–∫–∏.append([
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–∞–¥–º–∏–Ω", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–∞–¥–º–∏–Ω_–ø–∞–Ω–µ–ª—å"}
            ])
        
        return self.—Å–æ–∑–¥–∞—Ç—å_–∏–Ω–ª–∞–π–Ω_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(–∫–Ω–æ–ø–∫–∏)
    
    def –ø–æ–ª—É—á–∏—Ç—å_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É_–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤(self, —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: str = "ru") -> Dict[str, Any]:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤."""
        –∫–Ω–æ–ø–∫–∏ = [
            [
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–ø–æ–≥–æ–¥–∞", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–ø–æ–≥–æ–¥–∞"},
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–≤–∏–∫–∏–ø–µ–¥–∏—è", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–≤–∏–∫–∏–ø–µ–¥–∏—è"}
            ],
            [
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä"},
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è"}
            ]
        ]
        
        if –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.—Ñ—É–Ω–∫—Ü–∏–∏.–≤–∫–ª—é—á–∏—Ç—å_–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫:
            –∫–Ω–æ–ø–∫–∏.append([
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç_–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫"}
            ])
        
        –∫–Ω–æ–ø–∫–∏.append([
            {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–Ω–∞–∑–∞–¥", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–º–µ–Ω—é"}
        ])
        
        return self.—Å–æ–∑–¥–∞—Ç—å_–∏–Ω–ª–∞–π–Ω_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(–∫–Ω–æ–ø–∫–∏)
    
    def –ø–æ–ª—É—á–∏—Ç—å_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É_–ø–æ–¥–ø–∏—Å–∫–∏(self, —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: str = "ru") -> Dict[str, Any]:
        """–ü–æ–ª—É—á–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–æ–¥–ø–∏—Å–∫–∏."""
        –∫–Ω–æ–ø–∫–∏ = [
            [
                {"text": "üíé –ü—Ä–æ - 500‚ÇΩ/–º–µ—Å", "callback_data": "–ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è_–ø—Ä–æ"},
                {"text": "üëë –ö–æ–º–∞–Ω–¥–∞ - 1500‚ÇΩ/–º–µ—Å", "callback_data": "–ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è_–∫–æ–º–∞–Ω–¥–∞"}
            ],
            [
                {"text": –ø–æ–ª—É—á–∏—Ç—å_—Ç–µ–∫—Å—Ç("–∫–Ω–æ–ø–∫–∞_–Ω–∞–∑–∞–¥", —è–∑—ã–∫_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), "callback_data": "–≥–ª–∞–≤–Ω–æ–µ_–Ω–∞—Å—Ç—Ä–æ–π–∫–∏"}
            ]
        ]
        
        return self.—Å–æ–∑–¥–∞—Ç—å_–∏–Ω–ª–∞–π–Ω_–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É(–∫–Ω–æ–ø–∫–∏)
    
    # –ú–µ—Ç–æ–¥—ã –¥–µ–π—Å—Ç–≤–∏–π —á–∞—Ç–∞
    async def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–¥–µ–π—Å—Ç–≤–∏–µ_—á–∞—Ç–∞(self, –∏–¥_—á–∞—Ç–∞: Union[int, str], –¥–µ–π—Å—Ç–≤–∏–µ: str):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ —á–∞—Ç–∞ (–ø–µ—á–∞—Ç–∞–µ—Ç, –∑–∞–≥—Ä—É–∂–∞–µ—Ç_—Ñ–æ—Ç–æ –∏ —Ç.–¥.)."""
        –ø–∞—Ä–∞–º–µ—Ç—Ä—ã = {
            "chat_id": –∏–¥_—á–∞—Ç–∞,
            "action": –¥–µ–π—Å—Ç–≤–∏–µ
        }
        
        try:
            await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("sendChatAction", json=–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
        except Exception as e:
            –ª–æ–≥.warning("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ —á–∞—Ç–∞", –æ—à–∏–±–∫–∞=str(e))
    
    async def –ø–µ—á–∞—Ç–∞–µ—Ç(self, –∏–¥_—á–∞—Ç–∞: Union[int, str]):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –ø–µ—á–∞—Ç–∞–µ—Ç."""
        await self.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–¥–µ–π—Å—Ç–≤–∏–µ_—á–∞—Ç–∞(–∏–¥_—á–∞—Ç–∞, "typing")
    
    async def –∑–∞–≥—Ä—É–∂–∞–µ—Ç_—Ñ–æ—Ç–æ(self, –∏–¥_—á–∞—Ç–∞: Union[int, str]):
        """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ."""
        await self.–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–¥–µ–π—Å—Ç–≤–∏–µ_—á–∞—Ç–∞(–∏–¥_—á–∞—Ç–∞, "upload_photo")
    
    # –ú–µ—Ç–æ–¥—ã –∫–æ–ª–±–µ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤
    async def –æ—Ç–≤–µ—Ç–∏—Ç—å_–Ω–∞_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å(
        self,
        –∏–¥_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å–∞: str,
        —Ç–µ–∫—Å—Ç: Optional[str] = None,
        –ø–æ–∫–∞–∑–∞—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: bool = False,
        —Å—Å—ã–ª–∫–∞: Optional[str] = None
    ) -> bool:
        """–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –∫–æ–ª–±–µ–∫ –∑–∞–ø—Ä–æ—Å."""
        –ø–∞—Ä–∞–º–µ—Ç—Ä—ã = {
            "callback_query_id": –∏–¥_–∫–æ–ª–±–µ–∫_–∑–∞–ø—Ä–æ—Å–∞,
            "show_alert": –ø–æ–∫–∞–∑–∞—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        }
        
        if —Ç–µ–∫—Å—Ç:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["text"] = —Ç–µ–∫—Å—Ç
        if —Å—Å—ã–ª–∫–∞:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["url"] = —Å—Å—ã–ª–∫–∞
        
        await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("answerCallbackQuery", json=–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
        return True
    
    # –ú–µ—Ç–æ–¥—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
    async def —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å_—Ç–µ–∫—Å—Ç_—Å–æ–æ–±—â–µ–Ω–∏—è(
        self,
        –∏–¥_—á–∞—Ç–∞: Union[int, str],
        –∏–¥_—Å–æ–æ–±—â–µ–Ω–∏—è: int,
        —Ç–µ–∫—Å—Ç: str,
        —Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏: Optional[str] = "HTML",
        —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞: Optional[Dict] = None
    ) -> Dict[str, Any]:
        """–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è."""
        –ø–∞—Ä–∞–º–µ—Ç—Ä—ã = {
            "chat_id": –∏–¥_—á–∞—Ç–∞,
            "message_id": –∏–¥_—Å–æ–æ–±—â–µ–Ω–∏—è,
            "text": —Ç–µ–∫—Å—Ç,
            "parse_mode": —Ä–µ–∂–∏–º_—Ä–∞–∑–º–µ—Ç–∫–∏
        }
        
        if —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞:
            –ø–∞—Ä–∞–º–µ—Ç—Ä—ã["reply_markup"] = —Ä–∞–∑–º–µ—Ç–∫–∞_–æ—Ç–≤–µ—Ç–∞
        
        return await self._—Å–¥–µ–ª–∞—Ç—å_–∑–∞–ø—Ä–æ—Å("editMessageText", json=–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)